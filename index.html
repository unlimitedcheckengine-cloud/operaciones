<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CheckEngineRD Unlimited - Sistema de Citas</title>
    <!-- Importación de Bootstrap CSS y Font Awesome para íconos -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- FullCalendar CSS -->
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --success-color: #27ae60;
            --warning-color: #f39c12;
        }
        
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .logo {
            max-width: 180px;
            height: auto;
        }
        
        .navbar-custom {
            background-color: var(--primary-color);
        }
        
        .nav-pills .nav-link.active {
            background-color: var(--secondary-color);
        }
        
        .card-header-custom {
            background-color: var(--primary-color);
            color: white;
        }
        
        .btn-primary-custom {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
        }
        
        .btn-primary-custom:hover {
            background-color: #2980b9;
            border-color: #2980b9;
        }
        
        .stat-card {
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .table-responsive {
            max-height: 500px;
            overflow-y: auto;
        }
        
        .stat-value {
            font-weight: bold;
            font-size: 1.5rem;
        }
        
        .finanzas-icon {
            font-size: 1.2rem;
            margin-right: 5px;
            vertical-align: middle;
        }
        
        .badge {
            font-size: 0.85em;
        }
        
        .btn-action {
            padding: 0.25rem 0.5rem;
            font-size: 0.875rem;
        }
        
        .table th {
            position: sticky;
            top: 0;
            background-color: #f8f9fa;
            z-index: 10;
        }
        
        .btn-copiar {
            position: absolute;
            right: 15px;
            top: -45px;
        }
        
        .modal-backdrop {
            z-index: 1040 !important;
        }
        
        .modal {
            z-index: 1050 !important;
        }
        
        .tooltip-inner {
            max-width: 350px;
        }
        
        /* Estilos para el modal de agentes */
        .agente-item {
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .agente-item:hover {
            background-color: #f8f9fa;
        }
        
        /* Nuevos estilos para la interfaz mejorada */
        .dashboard-card {
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: none;
        }
        
        .dashboard-card:hover {
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        
        .summary-widget {
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            color: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .summary-value {
            font-size: 1.8rem;
            font-weight: bold;
        }
        
        .feature-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--secondary-color);
        }
        
        .main-container {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-top: 20px;
        }
        
        .welcome-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .config-section {
            margin-bottom: 25px;
            padding: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }
        
        @media (max-width: 768px) {
            .welcome-header h1 {
                font-size: 1.8rem;
            }
            
            .summary-value {
                font-size: 1.5rem;
            }
        }
        
        .logo-preview {
            max-width: 200px;
            max-height: 100px;
            margin-top: 10px;
            border: 1px dashed #ccc;
            padding: 5px;
        }

        .fc-event-dragging {
            opacity: 0.7;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        /* --- Estilos para el cupón --- */
        .cupon-container {
            background-color: #f4f7f9; /* Un gris muy claro */
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 0;
            border-radius: 15px;
            overflow: hidden;
        }
        .cupon-banner {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            text-align: center;
        }
        .cupon-banner img {
            max-height: 50px;
            filter: brightness(0) invert(1); /* Logo en blanco */
            margin-bottom: 10px;
        }
        .cupon-banner h3 {
            font-weight: bold;
            margin: 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }
        .cupon-body {
            padding: 20px;
        }
        .cupon-island {
            background-color: #ffffff;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .cupon-island h6 {
            color: var(--primary-color);
            font-weight: bold;
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 5px;
            margin-bottom: 10px;
        }
        .cupon-island p {
            margin-bottom: 5px;
            font-size: 0.95rem;
        }
        .cupon-island strong {
            color: #333;
        }
        .cupon-offer {
            border: 2px dashed var(--success-color);
            text-align: center;
        }
        .cupon-footer {
            padding: 15px 20px;
            background-color: #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .cupon-footer-text {
            font-size: 0.8rem;
            color: #6c757d;
        }
        .precio-original {
            text-decoration: line-through;
            color: #aaa;
            font-size: 1.2rem;
        }
        .precio-promocional {
            color: var(--success-color);
            font-size: 2.2rem;
            font-weight: bold;
        }
        .precio-cortesia {
            color: var(--secondary-color);
            font-size: 2rem;
            font-weight: bold;
        }
        .cupon-qr {
            text-align: right;
        }
        .cupon-qr img {
            max-width: 80px;
            border: 4px solid white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* --- Estilos para el nuevo diseño del calendario --- */
        .fc-event-main-custom {
            padding: 2px 4px;
            font-size: 0.8em;
            overflow: hidden;
            height: 100%;
        }
        .fc-event-title-container {
            margin-left: 5px;
        }
        .fc-event-title-custom {
            font-weight: bold;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .fc-event-desc {
            font-size: 0.9em;
            opacity: 0.8;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .fc-daygrid-event .fc-event-main-custom {
            display: flex;
            align-items: center;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark navbar-custom">
        <div class="container">
            <a class="navbar-brand" href="#">
                <img id="headerLogo" src="https://placehold.co/180x50/ffffff/3498db?text=CheckEngineRD" alt="Checkenginerd Unlimited" class="logo">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#"><i class="fas fa-home me-1"></i> Inicio</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#configuracionModal"><i class="fas fa-cog me-1"></i> Configuración</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="welcome-header text-center">
            <h1><i class="fas fa-calendar-check me-2"></i> <span id="headerEmpresaNombre">CheckEngineRD Unlimited</span></h1>
            <p class="lead">Sistema de Gestión de Citas</p>
        </div>

        <!-- Mensaje de confirmación o error -->
        <div id="mensajeContainer" class="position-fixed top-0 start-50 translate-middle-x mt-3" style="z-index: 1050; display: none;">
            <div id="mensajeAlerta" class="alert fade show" role="alert"></div>
        </div>

        <!-- Panel de resumen -->
        <div class="row mb-4">
            <div class="col-md-3 col-sm-6 mb-3">
                <div class="summary-widget text-center">
                    <div class="summary-value" id="resumenTotal">0</div>
                    <div>Total Citas</div>
                </div>
            </div>
            <div class="col-md-3 col-sm-6 mb-3">
                <div class="summary-widget text-center">
                    <div class="summary-value" id="resumenHoy">0</div>
                    <div>Citas Hoy</div>
                </div>
            </div>
            <div class="col-md-3 col-sm-6 mb-3">
                <div class="summary-widget text-center">
                    <div class="summary-value" id="resumenPendientes">0</div>
                    <div>Pendientes</div>
                </div>
            </div>
            <div class="col-md-3 col-sm-6 mb-3">
                <div class="summary-widget text-center">
                    <div class="summary-value" id="resumenFacturado">$0</div>
                    <div>Facturado</div>
                </div>
            </div>
        </div>

        <!-- Navegación por pestañas -->
        <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
            <li class="nav-item">
                <button class="nav-link active" id="pills-inicio-tab" data-bs-toggle="pill" data-bs-target="#pills-inicio" type="button" role="tab" aria-controls="pills-inicio" aria-selected="true">
                    <i class="fas fa-tachometer-alt me-1"></i> Inicio
                </button>
            </li>
            <li class="nav-item">
                <button class="nav-link" id="pills-citas-tab" data-bs-toggle="pill" data-bs-target="#pills-citas" type="button" role="tab" aria-controls="pills-citas" aria-selected="false">
                    <i class="fas fa-list me-1"></i> Gestionar Citas
                </button>
            </li>
            <li class="nav-item">
                <button class="nav-link" id="pills-nueva-tab" data-bs-toggle="pill" data-bs-target="#pills-nueva" type="button" role="tab" aria-controls="pills-nueva" aria-selected="false" onclick="limpiarFormularioNuevaCita()">
                    <i class="fas fa-plus-circle me-1"></i> Nueva Cita
                </button>
            </li>
            <li class="nav-item">
                <button class="nav-link" id="pills-reportes-tab" data-bs-toggle="pill" data-bs-target="#pills-reportes" type="button" role="tab" aria-controls="pills-reportes" aria-selected="false" onclick="generarReportes()">
                    <i class="fas fa-chart-bar me-1"></i> Reportes
                </button>
            </li>
            <li class="nav-item">
                <button class="nav-link" id="pills-agentes-tab" data-bs-toggle="pill" data-bs-target="#pills-agentes" type="button" role="tab" aria-controls="pills-agentes" aria-selected="false">
                    <i class="fas fa-users me-1"></i> Agentes
                </button>
            </li>
            <li class="nav-item">
                <button class="nav-link" id="pills-calendario-tab" data-bs-toggle="pill" data-bs-target="#pills-calendario" type="button" role="tab" aria-controls="pills-calendario" aria-selected="false">
                    <i class="fas fa-calendar-alt me-1"></i> Vista de Calendario
                </button>
            </li>
            <li class="nav-item">
                <button class="nav-link" id="pills-clientes-tab" data-bs-toggle="pill" data-bs-target="#pills-clientes" type="button" role="tab" aria-controls="pills-clientes" aria-selected="false">
                    <i class="fas fa-id-card me-1"></i> Clientes
                </button>
            </li>
        </ul>

        <!-- Contenido de las pestañas -->
        <div class="tab-content" id="pills-tabContent">
            <!-- Pestaña de Inicio (Dashboard) -->
            <div class="tab-pane fade show active" id="pills-inicio" role="tabpanel" aria-labelledby="pills-inicio-tab">
                <div class="row">
                    <div class="col-lg-8">
                        <!-- Próximas Citas -->
                        <div class="card dashboard-card mb-4">
                            <div class="card-header card-header-custom">
                                <h5 class="mb-0"><i class="fas fa-hourglass-half me-2"></i>Próximas Citas Pendientes</h5>
                            </div>
                            <div class="card-body">
                                <ul class="list-group list-group-flush" id="proximasCitasContainer">
                                    <!-- Las próximas citas se cargarán aquí -->
                                </ul>
                            </div>
                        </div>
                        <!-- Actividad Reciente -->
                        <div class="card dashboard-card mb-4">
                            <div class="card-header card-header-custom">
                                <h5 class="mb-0"><i class="fas fa-history me-2"></i>Actividad Reciente</h5>
                            </div>
                            <div class="card-body">
                                <ul class="list-group list-group-flush" id="actividadRecienteContainer">
                                    <!-- La actividad reciente se cargará aquí -->
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <!-- Acciones Rápidas -->
                        <div class="card dashboard-card">
                            <div class="card-header card-header-custom">
                                <h5 class="mb-0"><i class="fas fa-bolt me-2"></i>Acciones Rápidas</h5>
                            </div>
                            <div class="card-body">
                                <button class="btn btn-primary-custom w-100 mb-2" onclick="document.getElementById('pills-nueva-tab').click()"><i class="fas fa-plus-circle me-2"></i>Nueva Cita</button>
                                <button class="btn btn-info w-100 text-white" onclick="document.getElementById('pills-calendario-tab').click()"><i class="fas fa-calendar-alt me-2"></i>Ver Calendario</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pestaña de Gestión de Citas -->
            <div class="tab-pane fade" id="pills-citas" role="tabpanel" aria-labelledby="pills-citas-tab">
                <!-- Sección de Filtros, Estadísticas, Exportar y Guardar -->
                <div class="row mb-3" id="filtros">
                    <div class="col-md-12">
                        <div class="card dashboard-card">
                            <div class="card-header card-header-custom">
                                <h5 class="mb-0"><i class="fas fa-filter me-2"></i>Filtros y Acciones</h5>
                            </div>
                            <div class="card-body py-2 d-flex flex-wrap justify-content-between align-items-center">
                                <div id="grupo-filtros" class="btn-group btn-group-sm mb-2 mb-md-0 me-md-2" role="group" aria-label="Filtros por estado de cita">
                                    <button type="button" class="btn btn-outline-primary active" data-estado="todas">Todas</button>
                                    <button type="button" class="btn btn-outline-secondary" data-estado="pendiente">Pendientes</button>
                                    <button type="button" class="btn btn-outline-info" data-estado="recibido">Recibidos</button>
                                    <button type="button" class="btn btn-outline-success" data-estado="completada">Completadas</button>
                                    <button type="button" class="btn btn-outline-warning" data-estado="reagendada">Reagendadas</button>
                                    <button type="button" class="btn btn-outline-danger" data-estado="no_asistio">No Asistieron</button>
                                    <button type="button" class="btn btn-outline-dark" data-estado="cancelada">Canceladas</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sección de Estadísticas y Filtro Diario y Mensual -->
                <div class="card dashboard-card mb-4">
                    <div class="card-header card-header-custom">
                        <h5 class="mb-0"><i class="fas fa-chart-bar me-2"></i>Estadísticas y Filtros Avanzados</h5>
                    </div>
                    <div class="card-body">
                        <div class="row mb-3 align-items-end">
                            <div class="col-lg-4 col-md-12 mb-2 mb-lg-0">
                                <label for="filtroBusqueda" class="form-label">Buscar por texto:</label>
                                <input type="text" class="form-control" id="filtroBusqueda" placeholder="Nombre, teléfono, vehículo...">
                            </div>
                            <div class="col-lg-2 col-md-3 mb-2 mb-md-0">
                                <label for="filtroFecha" class="form-label">Por Día:</label>
                                <input type="date" class="form-control" id="filtroFecha">
                            </div>
                            <div class="col-lg-2 col-md-3 mb-2 mb-md-0">
                                <label for="filtroMes" class="form-label">Por Mes:</label>
                                <select class="form-select" id="filtroMes">
                                    <option value="">Todos los meses</option>
                                    <option value="01">Enero</option>
                                    <option value="02">Febrero</option>                                    
                                    <option value="03">Marzo</option>
                                    <option value="04">Abril</option>
                                    <option value="05">Mayo</option>
                                    <option value="06">Junio</option>
                                    <option value="07">Julio</option>
                                    <option value="08">Agosto</option>
                                    <option value="09">Septiembre</option>                                    
                                    <option value="10">Octubre</option>
                                    <option value="11">Noviembre</option>
                                    <option value="12">Diciembre</option>
                                </select>
                            </div>
                            <div class="col-lg-2 col-md-3 mb-2 mb-md-0">
                                <label for="filtroAnio" class="form-label">Por Año:</label>
                                <select class="form-select" id="filtroAnio">
                                    <option value="">Todos los años</option>
                                    <!-- Los años se cargarán dinámicamente -->
                                </select>
                            </div>
                            <div class="col-lg-2 col-md-3">
                                <div class="form-check form-switch mt-md-4">
                                    <input class="form-check-input" type="checkbox" id="filtroFacturado">
                                    <label class="form-check-label" for="filtroFacturado">Solo facturados</label>
                                </div>
                            </div>
                        </div>
                        <hr>
                        <div class="row text-center" id="estadisticasDiarias">
                            <div class="col-md-3 mb-2">
                                <div class="card h-100 stat-card">
                                    <div class="card-body">
                                        <h6 class="card-title text-muted">Total de Citas</h6>
                                        <p class="stat-value text-primary" id="statsTotal">0</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 mb-2">
                                <div class="card h-100 stat-card">
                                    <div class="card-body">
                                        <h6 class="card-title text-muted">Recibidas</h6>
                                        <p class="stat-value text-info" id="statsRecibidas">0</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 mb-2">
                                <div class="card h-100 stat-card">
                                    <div class="card-body">
                                        <h6 class="card-title text-muted">Monto Facturado</h6>
                                        <p class="stat-value text-success" id="statsMonto">$0.00 RD</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 mb-2">
                                <div class="card h-100 stat-card">
                                    <div class="card-body">
                                        <h6 class="card-title text-muted">Efectividad</h6>
                                        <p class="stat-value text-dark" id="statsEfectividad">0%</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Tarjeta para citas programadas y tabla -->
                <div class="card dashboard-card mb-4 position-relative">
                    <div class="card-header card-header-custom d-flex justify-content-between align-items-center">
                        <h5 class="mb-0"><i class="fas fa-list me-2"></i>Citas Programadas</h5>
                        <button id="btnCopiarLista" class="btn btn-sm btn-light" title="Copiar lista de citas">
                            <i class="fas fa-copy me-1"></i>Copiar Lista
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead class="table-light">
                                    <tr>
                                        <th>Fecha/Hora</th>
                                        <th>Cliente</th>
                                        <th>Marca</th>
                                        <th>Modelo</th>
                                        <th>Año</th>
                                        <th>Agente</th>
                                        <th>Estado</th>
                                        <th>Finanzas</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="listaCitas">
                                    <!-- Las citas se cargarán aquí dinámicamente con JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pestaña de Nueva Cita -->
            <div class="tab-pane fade" id="pills-nueva" role="tabpanel" aria-labelledby="pills-nueva-tab">
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <!-- Tarjeta para crear nueva cita -->
                        <div class="card dashboard-card">
                            <div class="card-header card-header-custom">
                                <h5 class="mb-0"><i class="fas fa-calendar-plus me-2"></i>Nueva Cita</h5>
                            </div>
                            <div class="card-body">
                                <form id="citaForm">
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="nombreCliente" class="form-label">Nombre del Cliente*</label>
                                            <input type="text" class="form-control" id="nombreCliente" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="telefono" class="form-label">Teléfono*</label>
                                            <input type="tel" class="form-control" id="telefono" required>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-4 mb-3">
                                            <label for="marca" class="form-label">Marca*</label>
                                            <input type="text" class="form-control" id="marca" required>
                                        </div>
                                        <div class="col-md-4 mb-3">
                                            <label for="modelo" class="form-label">Modelo*</label>
                                            <input type="text" class="form-control" id="modelo" required>
                                        </div>
                                        <div class="col-md-4 mb-3">
                                            <label for="anio" class="form-label">Año*</label>
                                            <input type="number" class="form-control" id="anio" min="1900" max="2099" required>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="fecha" class="form-label">Fecha de Servicio*</label>
                                            <input type="date" class="form-control" id="fecha" required min="${new Date().toISOString().split('T')[0]}">
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="hora" class="form-label">Hora de Servicio*</label>
                                            <select class="form-select" id="hora" required>
                                                <option value="08:00">8:00 AM</option>
                                                <option value="09:00">9:00 AM</option>
                                                <option value="10:00">10:00 AM</option>
                                                <option value="11:00">11:00 AM</option>
                                                <option value="12:00">12:00 PM</option>
                                                <option value="13:00">1:00 PM</option>
                                                <option value="14:00">2:00 PM</option>
                                                <option value="15:00">3:00 PM</option>
                                                <option value="16:00">4:00 PM</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label for="servicio" class="form-label">Tipo de Servicio*</label>
                                        <select class="form-select" id="servicio" required>
                                            <option value="">Seleccione un servicio...</option>
                                            <option value="Chequeo General">Chequeo General</option>
                                            <option value="Chequeo libre de costo">Chequeo libre de costo</option>
                                            <option value="Mantenimiento Inyección">Mantenimiento Inyección</option>
                                            <option value="Cambio de Aceite">Cambio de Aceite</option>
                                            <option value="Diagnóstico Computarizado">Diagnóstico Computarizado</option>
                                            <option value="Trabajo a Realizar">Trabajo a Realizar</option>
                                            <option value="Otro">Otro</option>
                                        </select>
                                    </div>
                                    <div class="mb-3" id="otroServicioContainer" style="display: none;">
                                        <label for="otroServicio" class="form-label">Especificar Servicio</label>
                                        <input type="text" class="form-control" id="otroServicio">
                                    </div>
                                    <div class="mb-3">
                                        <label for="notas" class="form-label">Notas Adicionales</label>
                                        <textarea class="form-control" id="notas" rows="3" placeholder="Describa cualquier problema o detalle adicional..."></textarea>
                                    </div>
                                    <div class="mb-3">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="esPromocion">
                                            <label class="form-check-label" for="esPromocion">Activar Promoción</label>
                                        </div>
                                    </div>
                                    <div id="promoContainer" class="row" style="display: none;">
                                        <div class="col-md-6 mb-3">
                                            <label for="precioRegular" class="form-label">Precio Regular</label>
                                            <input type="number" class="form-control" id="precioRegular" placeholder="Ej: 1500">
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="precioPromocional" class="form-label">Precio Promocional</label>
                                            <input type="number" class="form-control" id="precioPromocional" placeholder="Ej: 995">
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label for="agente" class="form-label">Agente de Ventas</label>
                                        <div class="input-group">
                                            <select class="form-select" id="agente" required>
                                                <option value="">Seleccione un agente...</option>
                                                <!-- Los agentes se cargarán dinámicamente -->
                                            </select>
                                            <button type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#gestionAgentesModal">
                                                <i class="fas fa-cog"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <button type="submit" class="btn btn-primary-custom w-100 py-2">
                                        <i class="fas fa-save me-2"></i>Programar Cita
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pestaña de Reportes -->
            <div class="tab-pane fade" id="pills-reportes" role="tabpanel" aria-labelledby="pills-reportes-tab">
                <!-- Sección de Filtros para Reportes -->
                <div class="card dashboard-card mb-4">
                    <div class="card-header card-header-custom">
                        <h5 class="mb-0"><i class="fas fa-filter me-2"></i>Filtros para Reportes</h5>
                    </div>
                    <div class="card-body">
                        <div class="row mb-3 align-items-end">
                            <div class="col-md-3 mb-3">
                                <label for="filtroReporteFechaInicio" class="form-label">Fecha Inicio:</label>
                                <input type="date" class="form-control" id="filtroReporteFechaInicio">
                            </div>
                            <div class="col-md-3 mb-3">
                                <label for="filtroReporteFechaFin" class="form-label">Fecha Fin:</label>
                                <input type="date" class="form-control" id="filtroReporteFechaFin">
                            </div>
                            <div class="col-md-3 mb-3">
                                <label for="filtroReporteAgente" class="form-label">Agente:</label>
                                <select class="form-select" id="filtroReporteAgente">
                                    <option value="">Todos los agentes</option>
                                    <!-- Agentes se cargarán dinámicamente -->
                                </select>
                            </div>
                            <div class="col-md-3 mb-3">
                                <label for="filtroReporteServicio" class="form-label">Servicio:</label>
                                <select class="form-select" id="filtroReporteServicio">
                                    <option value="">Todos los servicios</option>
                                    <!-- Servicios se cargarán dinámicamente -->
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-9">
                                <label class="form-label">Estado de Cita:</label>
                                <div id="grupo-filtros-reportes" class="btn-group btn-group-sm w-100" role="group" aria-label="Filtros por estado de cita en reportes">
                                    <button type="button" class="btn btn-outline-primary active" data-estado="todas">Todas</button>
                                    <button type="button" class="btn btn-outline-secondary" data-estado="pendiente">Pendientes</button>
                                    <button type="button" class="btn btn-outline-info" data-estado="recibido">Recibidos</button>
                                    <button type="button" class="btn btn-outline-success" data-estado="completada">Completadas</button>
                                    <button type="button" class="btn btn-outline-warning" data-estado="reagendada">Reagendadas</button>
                                    <button type="button" class="btn btn-outline-danger" data-estado="no_asistio">No Asistieron</button>
                                    <button type="button" class="btn btn-outline-dark" data-estado="cancelada">Canceladas</button>
                                </div>
                            </div>
                            <div class="col-md-3 d-flex align-items-center">
                                <div class="form-check form-switch mt-3">
                                    <input class="form-check-input" type="checkbox" id="filtroReporteFacturado">
                                    <label class="form-check-label" for="filtroReporteFacturado">Solo facturados</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Contenido de Reportes (Gráficos y Tabla) -->
                <div class="row">
                    <div class="col-md-6 mb-4">
                        <div class="card dashboard-card h-100">
                            <div class="card-header card-header-custom">
                                <h5 class="mb-0"><i class="fas fa-chart-pie me-2"></i>Resumen por Estado</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="estadoChart" height="250"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mb-4">
                        <div class="card dashboard-card h-100">
                            <div class="card-header card-header-custom">
                                <h5 class="mb-0"><i class="fas fa-chart-line me-2"></i>Facturación Mensual</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="facturacionChart" height="250"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card dashboard-card">
                    <div class="card-header card-header-custom">
                        <h5 class="mb-0"><i class="fas fa-table me-2"></i>Reporte Detallado</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Agente</th>
                                        <th>Citas Programadas</th>
                                        <th>Citas Completadas</th>
                                        <th>Monto Facturado</th>
                                        <th>Efectividad</th>
                                    </tr>
                                </thead>
                                <tbody id="tablaReportes">
                                    <!-- Los reportes se generarán aquí -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pestaña de Gestión de Agentes -->
            <div class="tab-pane fade" id="pills-agentes" role="tabpanel" aria-labelledby="pills-agentes-tab">
                <div class="card dashboard-card">
                    <div class="card-header card-header-custom d-flex justify-content-between align-items-center">
                        <h5 class="mb-0"><i class="fas fa-users me-2"></i>Gestión de Agentes</h5>
                        <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#gestionAgentesModal">
                            <i class="fas fa-plus me-1"></i>Agregar Agente
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Nombre</th>
                                        <th>Email</th>
                                        <th>Teléfono</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="tablaAgentes">
                                    <!-- Los agentes se cargarán aquí -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pestaña de Calendario -->
            <div class="tab-pane fade" id="pills-calendario" role="tabpanel" aria-labelledby="pills-calendario-tab">
                <div class="card dashboard-card">
                    <div class="card-header card-header-custom">
                        <h5 class="mb-0"><i class="fas fa-calendar-alt me-2"></i>Calendario de Citas</h5>
                    </div>
                    <div class="card-body">
                        <div id="calendario"></div>
                    </div>
                </div>
            </div>

            <!-- Pestaña de Clientes -->
            <div class="tab-pane fade" id="pills-clientes" role="tabpanel" aria-labelledby="pills-clientes-tab">
                <div class="row">
                    <!-- Columna de Lista de Clientes -->
                    <div class="col-md-4">
                        <div class="card dashboard-card">
                            <div class="card-header card-header-custom d-flex justify-content-between align-items-center">
                                <h5 class="mb-0"><i class="fas fa-users me-2"></i>Lista de Clientes</h5>
                                <button class="btn btn-sm btn-light" id="btnNuevoCliente">
                                    <i class="fas fa-plus me-1"></i>Nuevo
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <input type="text" id="filtroClientes" class="form-control" placeholder="Buscar cliente por nombre o teléfono...">
                                </div>
                                <div class="list-group" id="listaClientes" style="max-height: 600px; overflow-y: auto;">
                                    <!-- Clientes se cargarán aquí -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Columna de Historial del Cliente -->
                    <div class="col-md-8">
                        <div id="historialClienteContainer" class="card dashboard-card" style="display: none;">
                            <div class="card-header card-header-custom">
                                <h5 class="mb-0"><i class="fas fa-history me-2"></i>Historial de <span id="nombreClienteHistorial"></span></h5>
                            </div>
                            <div class="card-body">
                                <p><strong>Teléfono:</strong> <span id="telefonoClienteHistorial"></span></p>
                                <div id="tablaHistorialCliente" class="table-responsive" style="max-height: 550px;">
                                    <!-- Historial se cargará aquí -->
                                </div>
                            </div>
                        </div>
                        <div id="placeholderCliente" class="text-center mt-5 pt-5">
                            <i class="fas fa-id-card fa-4x text-muted"></i>
                            <p class="mt-3 text-muted">Seleccione un cliente para ver su historial.</p>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Modal para importar desde Excel -->
    <div class="modal fade" id="importarExcelModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-info text-white">
                    <h5 class="modal-title">Importar desde Excel/CSV</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="archivoExcel" class="form-label">Seleccionar archivo Excel/CSV</label>
                        <input class="form-control" type="file" id="archivoExcel" accept=".xlsx,.xls,.csv">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Opciones de importación</label>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="corregirFechas" checked>
                            <label class="form-check-label" for="corregirFechas">
                                Corregir formato de fechas automáticamente
                            </label>
                        </div>
                        <small class="form-text text-muted">Esta opción intentará detectar y corregir formatos de fecha incorrectos durante la importación.</small>
                    </div>
                    <div class="mb-3">
                        <h6 class="form-label">Vista previa de datos</h6>
                        <div class="import-preview table-responsive">
                            <table class="table table-sm table-bordered">
                                <thead>
                                    <tr>
                                        <th>Nombre</th>
                                        <th>Teléfono</th>
                                        <th>Marca</th>
                                        <th>Modelo</th>
                                        <th>Año</th>
                                        <th>Fecha</th>
                                        <th>Hora</th>
                                        <th>Servicio</th>
                                        <th>Estado</th>
                                    </tr>
                                </thead>
                                <tbody id="vistaPreviaDatos">
                                    <tr>
                                        <td colspan="9" class="text-center">No hay datos para mostrar</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="sobrescribirDatos">
                        <label class="form-check-label" for="sobrescribirDatos">
                            Sobrescribir datos existentes
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="btnConfirmarImportacion">Importar Datos</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para seleccionar agente -->
    <div class="modal fade" id="seleccionarAgenteModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title">Seleccionar Agente</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="filtroAgente" class="form-label">Filtrar agentes:</label>
                        <input type="text" class="form-control" id="filtroAgente" placeholder="Buscar agente...">
                    </div>
                    <div class="list-group" id="listaAgentes">
                        <!-- Lista de agentes se cargará aquí -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="btnSeleccionarAgente">Seleccionar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para el cupón -->
    <div class="modal fade" id="cuponModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content border-0">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title">Cupón de Servicio</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body p-0" id="cuponContent">
                    <!-- Contenido del cupón se generará aquí -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-primary" onclick="imprimirCupon()">
                        <i class="fas fa-print me-1"></i>Imprimir
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para editar cita -->
    <div class="modal fade" id="editarCitaModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-warning text-dark">
                    <h5 class="modal-title">Editar Cita</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editarCitaForm">
                        <input type="hidden" id="editarId">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="editarNombreCliente" class="form-label">Nombre del Cliente*</label>
                                <input type="text" class="form-control" id="editarNombreCliente" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="editarTelefono" class="form-label">Teléfono*</label>
                                <input type="tel" class="form-control" id="editarTelefono" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label for="editarMarca" class="form-label">Marca*</label>
                                <input type="text" class="form-control" id="editarMarca" required>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="editarModelo" class="form-label">Modelo*</label>
                                <input type="text" class="form-control" id="editarModelo" required>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="editarAnio" class="form-label">Año*</label>
                                <input type="number" class="form-control" id="editarAnio" min="1900" max="2099" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="editarFecha" class="form-label">Fecha de Servicio*</label>
                                <input type="date" class="form-control" id="editarFecha" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="editarHora" class="form-label">Hora de Servicio*</label>
                                <select class="form-select" id="editarHora" required>
                                    <option value="08:00">8:00 AM</option>
                                    <option value="09:00">9:00 AM</option>
                                    <option value="10:00">10:00 AM</option>
                                    <option value="11:00">11:00 AM</option>
                                    <option value="12:00">12:00 PM</option>
                                    <option value="13:00">1:00 PM</option>
                                    <option value="14:00">2:00 PM</option>
                                    <option value="15:00">3:00 PM</option>
                                    <option value="16:00">4:00 PM</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="editarServicio" class="form-label">Tipo de Servicio*</label>
                            <select class="form-select" id="editarServicio" required>
                                <option value="">Seleccione un servicio...</option>
                                <option value="Chequeo General">Chequeo General</option>
                                <option value="Chequeo libre de costo">Chequeo libre de costo</option>
                                <option value="Mantenimiento Inyección">Mantenimiento Inyección</option>
                                <option value="Cambio de Aceite">Cambio de Aceite</option>
                                <option value="Diagnóstico Computarizado">Diagnóstico Computarizado</option>
                                <option value="Trabajo a Realizar">Trabajo a Realizar</option>
                                <option value="Otro">Otro</option>
                            </select>
                        </div>
                        <div class="mb-3" id="editarOtroServicioContainer" style="display: none;">
                            <label for="editarOtroServicio" class="form-label">Especificar Servicio</label>
                            <input type="text" class="form-control" id="editarOtroServicio">
                        </div>
                        <div class="mb-3">
                            <label for="editarNotas" class="form-label">Notas Adicionales</label>
                            <textarea class="form-control" id="editarNotas" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="editarAgente" class="form-label">Agente de Ventas</label>
                            <select class="form-select" id="editarAgente">
                                <option value="">Seleccione un agente...</option>
                                <!-- Los agentes se cargarán dinámicamente -->
                            </select>
                        </div>
                        <hr>
                        <div class="mb-3">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="editarEsPromocion">
                                <label class="form-check-label" for="editarEsPromocion">Activar Promoción</label>
                            </div>
                        </div>
                        <div id="editarPromoContainer" class="row" style="display: none;">
                            <div class="col-md-6 mb-3">
                                <label for="editarPrecioRegular" class="form-label">Precio Regular</label>
                                <input type="number" class="form-control" id="editarPrecioRegular" placeholder="Ej: 1500">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="editarPrecioPromocional" class="form-label">Precio Promocional</label>
                                <input type="number" class="form-control" id="editarPrecioPromocional" placeholder="Ej: 995">
                            </div>
                        </div>
                        <hr>
                        <h6 class="fw-bold">Datos Financieros y de Estado</h6>
                        <div class="mb-3">
                            <label for="editarEstado" class="form-label">Estado</label>
                            <select class="form-select" id="editarEstado">
                                <option value="pendiente">Pendiente</option>
                                <option value="recibido">Recibido</option>
                                <option value="completada">Completada</option>
                                <option value="reagendada">Reagendada</option>
                                <option value="no_asistio">No Asistió</option>
                                <option value="cancelada">Cancelada</option>
                            </select>
                        </div>
                        <div class="mb-3 form-check">
                            <input class="form-check-input" type="checkbox" id="editarFacturado">
                            <label class="form-check-label" for="editarFacturado">
                                ¿Facturado?
                            </label>
                        </div>
                        <div class="mb-3" id="editarMontoContainer">
                            <label for="editarMonto" class="form-label">Monto Facturado (<span id="simboloMoneda">$</span>)</label>
                            <div class="input-group">
                                <span class="input-group-text" id="simboloMonedaInput">$</span>
                                <input type="text" class="form-control" id="editarMonto" placeholder="0.00">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="editarTieneCotizacion" class="form-label">¿Tiene Cotización?</label>
                            <select class="form-select" id="editarTieneCotizacion">
                                <option value="no_aplica">No aplica</option>
                                <option value="si">Sí</option>
                                <option value="no">No</option>
                            </select>
                        </div>
                        <div class="mb-3" id="editarMotivoCotizacionContainer" style="display: none;">
                            <label for="editarMotivoCotizacion" class="form-label">Motivo de no tener cotización</label>
                            <textarea class="form-control" id="editarMotivoCotizacion" rows="2"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-warning" id="btnGuardarEdicion">
                        <i class="fas fa-save me-1"></i>Guardar Cambios
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de confirmación para eliminar -->
    <div class="modal fade" id="confirmarEliminarModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title">Confirmar Eliminación</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>¿Estás seguro de que quieres eliminar esta cita?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" id="btnConfirmarEliminar">Eliminar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Configuración -->
    <div class="modal fade" id="configuracionModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title"><i class="fas fa-cog me-2"></i>Configuración del Sistema</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="config-section">
                        <h5 class="mb-3"><i class="fas fa-building me-2"></i>Datos de la Empresa</h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="configNombreEmpresa" class="form-label">Nombre de la Empresa</label>
                                <input type="text" class="form-control" id="configNombreEmpresa" value="CheckEngineRD Unlimited">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="configSucursal" class="form-label">Sucursal</label>
                                <input type="text" class="form-control" id="configSucursal" value="Santo Domingo">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="configDireccion" class="form-label">Dirección</label>
                                <input type="text" class="form-control" id="configDireccion" value="Av. de los Próceres 25, Santo Domingo">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="configTelefono" class="form-label">Teléfono</label>
                                <input type="text" class="form-control" id="configTelefono" value="(809) 555-1234">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="configQrUrl" class="form-label">URL para Código QR (Opcional)</label>
                            <input type="text" class="form-control" id="configQrUrl" placeholder="Ej: https://instagram.com/tu_taller">
                        </div>
                    </div>

                    <div class="config-section">
                        <h5 class="mb-3"><i class="fas fa-palette me-2"></i>Apariencia</h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="configPrimaryColor" class="form-label">Color Primario (Banners, Encabezados)</label>
                                <input type="color" class="form-control form-control-color" id="configPrimaryColor" value="#2c3e50">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="configSecondaryColor" class="form-label">Color Secundario (Botones, Énfasis)</label>
                                <input type="color" class="form-control form-control-color" id="configSecondaryColor" value="#3498db">
                            </div>
                        </div>
                    </div>

                    <div class="config-section">
                        <h5 class="mb-3"><i class="fas fa-image me-2"></i>Logo de la Empresa</h5>
                        <div class="mb-3">
                            <label for="configLogo" class="form-label">Seleccionar Logo</label>
                            <input class="form-control" type="file" id="configLogo" accept="image/*">
                        </div>
                        <div class="mb-3">
                            <h6 class="form-label">Vista Previa</h6>
                            <div>
                                <img id="logoPreview" src="https://placehold.co/180x50/ffffff/3498db?text=CheckEngineRD" class="logo-preview" alt="Vista previa del logo">
                            </div>
                        </div>
                    </div>

                    <div class="config-section">
                        <h5 class="mb-3"><i class="fas fa-database me-2"></i>Gestión de Datos y Respaldos</h5>
                        <p class="text-muted">Guarda un respaldo completo del sistema o importa datos desde un archivo.</p>
                        <div class="btn-group w-100" role="group">
                            <button id="btnGuardarManual" class="btn btn-primary">
                                <i class="fas fa-download me-1"></i> Guardar Respaldo
                            </button>
                            <label for="importarArchivo" class="btn btn-info mb-0">
                                <i class="fas fa-upload me-1"></i> Importar Respaldo
                            </label>
                            <input type="file" id="importarArchivo" class="d-none" accept=".json">
                        </div>
                        <hr>
                        <p class="text-muted">Exporta la lista de citas actual (con filtros aplicados) a un archivo de Excel/CSV o importa desde uno.</p>
                        <div class="btn-group w-100" role="group">
                             <button id="btnExportarExcel" class="btn btn-success">
                                <i class="fas fa-file-excel me-1"></i> Exportar a Excel
                            </button>
                            <button id="btnImportarExcel" class="btn btn-warning">
                                <i class="fas fa-file-import me-1"></i> Importar desde Excel
                            </button>
                        </div>
                    </div>

                    <div class="config-section">
                        <h5 class="mb-3"><i class="fas fa-money-bill-wave me-2"></i>Configuración Monetaria</h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="configMoneda" class="form-label">Moneda</label>
                                <select class="form-select" id="configMoneda">
                                    <option value="RD">Peso Dominicano (RD$)</option>
                                    <option value="USD">Dólar Estadounidense (USD$)</option>
                                    <option value="EUR">Euro (€)</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="configFormatoMoneda" class="form-label">Formato de Moneda</label>
                                <select class="form-select" id="configFormatoMoneda">
                                    <option value="es-DO">Formato Dominicano (RD$ 1,000.00)</option>
                                    <option value="en-US">Formato Estadounidense ($1,000.00)</option>
                                    <option value="de-DE">Formato Europeo (1.000,00 €)</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="btnGuardarConfiguracion">Guardar Configuración</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Gestión de Agentes -->
    <div class="modal fade" id="gestionAgentesModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title"><i class="fas fa-users me-2"></i>Gestión de Agentes</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="agenteForm">
                        <input type="hidden" id="agenteId">
                        <div class="mb-3">
                            <label for="agenteNombre" class="form-label">Nombre completo*</label>
                            <input type="text" class="form-control" id="agenteNombre" required>
                        </div>
                        <div class="mb-3">
                            <label for="agenteEmail" class="form-label">Correo electrónico</label>
                            <input type="email" class="form-control" id="agenteEmail">
                        </div>
                        <div class="mb-3">
                            <label for="agenteTelefono" class="form-label">Teléfono</label>
                            <input type="tel" class="form-control" id="agenteTelefono">
                        </div>
                        <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input" id="agenteActivo" checked>
                            <label class="form-check-label" for="agenteActivo">Agente activo</label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" id="btnEliminarAgente" style="display: none;">Eliminar</button>
                    <button type="button" class="btn btn-primary" id="btnGuardarAgente">Guardar Agente</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Gestión de Clientes -->
    <div class="modal fade" id="clienteModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title"><i class="fas fa-user-plus me-2"></i>Gestión de Cliente</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="clienteForm">
                        <input type="hidden" id="clienteId">
                        <div class="mb-3">
                            <label for="clienteNombre" class="form-label">Nombre completo*</label>
                            <input type="text" class="form-control" id="clienteNombre" required>
                        </div>
                        <div class="mb-3">
                            <label for="clienteTelefono" class="form-label">Teléfono*</label>
                            <input type="tel" class="form-control" id="clienteTelefono" required>
                        </div>
                        <div class="mb-3">
                            <label for="clienteEmail" class="form-label">Correo electrónico</label>
                            <input type="email" class="form-control" id="clienteEmail">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-success" id="btnGuardarCliente">Guardar Cliente</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts de Bootstrap y JavaScript personalizado -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Librerías adicionales -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- FullCalendar JS y locale español -->
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/locales/es.js"></script>

    <script src="app.js"></script>
</body>
</html>